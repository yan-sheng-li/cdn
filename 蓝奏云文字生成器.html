<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>蓝奏云链接快速拆分生成器</title>
<style>
    body{font-family:Microsoft YaHei,Arial;background:#f0f2f5;padding:30px;max-width:800px;margin:0 auto;}
    h1{color:#333;text-align:center;}
    textarea{width:100%;height:100px;padding:15px;font-size:16px;border:1px solid #ddd;border-radius:8px;}
    button{background:#007bff;color:#fff;border:none;padding:12px 24px;margin:10px 5px 0 0;border-radius:6px;cursor:pointer;font-size:15px;}
    button:hover{background:#0056b3;}
    .out{background:#fff;padding:20px;border-radius:8px;margin-top:20px;line-height:2;border:1px solid #eee;}
    .copy{background:#28a745;}
    .copy:hover{background:#218838;}
    .tip{color:#666;text-align:center;margin-top:30px;}
</style>
</head>
<body>

<h1>蓝奏云链接快速拆分生成器</h1>
<p>直接把这一整行粘贴进来（支持多种写法）：</p>
<textarea id="input" placeholder="粘贴这里，例如：
https://liyansheng.lanzoub.com/b009hku13c 密码:5syp
或者
链接：https://www.lanzoub.com/iQ5zF2abcde  密码 1234
都可以自动识别">https://liyansheng.lanzoub.com/b009hku13c 密码:5syp</textarea>

<button onclick="parseAndGenerate()">立即生成</button>
<button onclick="document.getElementById('input').value='';document.getElementById('result').style.display='none';">清空</button>

<div id="result" class="out" style="display:none;">
    <div id="output"></div>
    <hr>
    <button class="copy" onclick="copy(1)">复制第1段（链接）</button>
    <button class="copy" onclick="copy(2)">复制第2段（完整说明）</button>
    <span style="color:green;margin-left:15px;" id="msg"></span>
</div>

<div class="tip">
    使用方法：粘贴完整一行 → 点击“立即生成” → 直接点对应按钮复制即可发给买家
</div>

<script>
// 全局变量保存解析结果
let link = "";
let pwd = "";

function parseAndGenerate() {
    const text = document.getElementById('input').value.trim();
    if (!text) {
        alert("请先粘贴链接和密码！");
        return;
    }

    // 支持多种常见写法，超强容错
    const urlMatch = text.match(/(https?:\/\/[^\s]+)/);
    const pwdMatch = text.match(/(?:密码|passwd|pwd|提取码)[:：\s]*([a-z0-9]{1,20})/i);

    if (!urlMatch) {
        alert("没检测到有效链接，请检查格式！");
        return;
    }

    link = urlMatch[1].split('?')[0]; // 去掉可能的参数
    pwd = pwdMatch ? pwdMatch[1] : "（未检测到密码）";

    const text1 = `${link} 【复制按钮】`;
    const text2 = `\n打开链接输入密码【${pwd}】即可，无需转存，点击文件立即下载。\n如有问题，请联系店铺客服 【复制按钮】`;

    document.getElementById('output').innerHTML = 
        '<strong>第1段（发链接用）：</strong><br>' + text1.replace(/【复制按钮】/g,'<span style="color:#007bff;">【复制按钮】</span>') +
        '<br><br><strong>第2段（完整说明用）：</strong>' + text2.replace(/【复制按钮】/g,'<span style="color:#007bff;">【复制按钮】</span>');
    
    document.getElementById('result').style.display = 'block';

    // 保存供复制用（复制时自动去掉【复制按钮】四个字）
    window.toCopy = {
        1: link,
        2: `打开链接输入密码【${pwd}】即可，无需转存，点击文件立即下载。\n如有问题，请联系店铺客服`
    };
}

function copy(num) {
    navigator.clipboard.writeText(window.toCopy[num]).then(()=>{
        document.getElementById('msg').textContent = '✔ 已复制！';
        setTimeout(()=>document.getElementById('msg').textContent='',2000);
    }).catch(()=>{
        alert('复制失败，请手动选择复制');
    });
}
</script>

</body>
</html>