<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æœ¨å­ç©ºé—´</title>
  <link rel="icon" type="image/x-icon" href="https://cdn.qiniu.liyansheng.top/img/graphic-4005286_640.png" />
  <link href="https://cdn.jsdelivr.net/gh/squarechip/timeline@master/dist/css/timeline.min.css" rel="stylesheet" />

  <style>
    /* åŸºç¡€æ ·å¼ï¼ˆé€šç”¨ï¼‰ */
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
      margin: 0;
      padding: 0 0 20px 0;
      transition: background 0.3s, color 0.3s;
    }

    .container {
      max-width: 960px;
      margin: 0 auto;
      &#10;
      padding: 0 20px;
    }

    h1 {
      font-size: 20px;
      margin: 0 0 8px
    }

    p.lead {
      margin: 0 0 6px;
      font-size: 14px;
    }

    /* æœåŠ¡ä¿¡æ¯å¡ç‰‡æ•ˆæœ */
    .service-card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
      padding: 12px 16px 8px 16px;
      margin-bottom: 20px;
      border: 1px solid #f0f2f5;
      transition: box-shadow 0.3s;
      /* å¸é¡¶ */
      position: sticky;
      top: 0;
      z-index: 10;
    }

    body.dark-theme .service-card {
      background: #16213a;
      border: 1px solid #222c44;
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.18);
    }

    /* æ»šåŠ¨é€šçŸ¥æ ·å¼ */
    .marquee-container {
      width: 100%;
      overflow: hidden;
      background: linear-gradient(90deg, #3b82f6, #60a5fa);
      color: white;
      padding: 8px 0;
      margin-bottom: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .marquee-content {
      display: inline-block;
      white-space: nowrap;
      animation: marquee-scroll 20s linear infinite;
      padding-left: 100%;
    }

    @keyframes marquee-scroll {
      0% {
        transform: translateX(0);
      }

      100% {
        transform: translateX(-100%);
      }
    }

    .marquee-container:hover .marquee-content {
      animation-play-state: paused;
    }

    /* æŒ‰é’®æ ·å¼ */
    .theme-toggle {
      position: fixed;
      top: 46px;
      right: 16px;
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background: #60a5fa;
      color: #fff;
      font-size: 14px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, .2);
      z-index: 1000;
    }

    /* æ—¶é—´è½´é€šç”¨ */
    .timeline__content {
      border-radius: 12px;
      padding: 12px 14px;
      transition: background 0.3s, color 0.3s, border-color 0.3s;
      position: relative;
      /* æ–°å¢ï¼šä¸ºæ ‡ç­¾å®šä½æä¾›ç›¸å¯¹å®¹å™¨ */
    }

    .timeline__content h3 {
      margin: 0 0 4px;
      font-size: 15px;
      letter-spacing: .2px;
    }

    .timeline__content .meta {
      display: flex;
      gap: 6px;
      align-items: center;
      font-size: 11px;
      margin-bottom: 6px;
    }

    .timeline__content .meta .tag {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
    }

    .timeline__content.is-current {
      outline: 2px solid #60a5fa;
      outline-offset: -10px;
    }

    /* æ–°å¢ï¼šæœ€æ–°æ ‡ç­¾æ ·å¼ */
    .latest-badge {
      position: absolute;
      top: -8px;
      right: 8px;
      background: #60a5fa;
      color: white;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: bold;
      z-index: 1;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
    }

    body.dark-theme .latest-badge {
      background: #3b82f6;
    }

    /* æš—è‰²ä¸»é¢˜ */
    body.dark-theme {
      background: #0b1220;
      color: #e5e7eb;
    }

    body.dark-theme .marquee-container {
      background: linear-gradient(90deg, #1e40af, #1d4ed8);
    }

    body.dark-theme p.lead {
      color: #9ca3af;
    }

    body.dark-theme .timeline__content {
      background: #0f172a;
      border: 1px solid rgba(255, 255, 255, .06);
    }

    body.dark-theme .timeline__content h3 {
      color: #e2e8f0;
    }

    body.dark-theme .timeline__content .meta {
      color: #9ca3af;
    }

    body.dark-theme .timeline__content .meta .tag {
      border: 1px solid rgba(255, 255, 255, .12);
    }

    body.dark-theme .timeline__content p {
      color: #cbd5e1;
    }

    body.dark-theme .timeline:before {
      background: rgba(148, 163, 184, .25)
    }

    /* æµ…è‰²ä¸»é¢˜ */
    body.light-theme {
      background: #ffffff;
      color: #333333;
    }

    body.light-theme .marquee-container {
      background: linear-gradient(90deg, #2563eb, #3b82f6);
    }

    body.light-theme p.lead {
      color: #555555;
    }

    body.light-theme .timeline__content {
      background: #ffffff;
      border: 1px solid rgba(0, 0, 0, .1);
    }

    body.light-theme .timeline__content h3 {
      color: #111111;
    }

    body.light-theme .timeline__content .meta {
      color: #555555;
    }

    body.light-theme .timeline__content .meta .tag {
      border: 1px solid rgba(0, 0, 0, .12);
    }

    body.light-theme .timeline__content p {
      color: #444444;
    }

    body.light-theme .timeline:before {
      background: rgba(0, 0, 0, .15)
    }

    #countdown-timer {
      font-weight: bold;
      color: #ee1532;
      text-align: center;
      line-height: 2;
    }
  </style>
</head>

<body class="dark-theme">
  <button class="theme-toggle" id="theme-toggle">åˆ‡æ¢ä¸»é¢˜</button>

  <!-- æ»šåŠ¨é€šçŸ¥å…¬å‘Š -->
  <div class="marquee-container">
    <div class="marquee-content">
      <span>ğŸ“¢ æœ¨å­ç©ºé—´ï¼šé¡¹ç›®å®šåˆ¶ | è¿œç¨‹è°ƒè¯• | Bugå®¡æŸ¥ä¿®å¤ | é¡¹ç›®å‡çº§æ”¹é€  | é—®é¢˜æ¢è®¨</span>
    </div>
  </div>

  <div class="container">
    <div class="service-card">
      <div id="service-info"></div>
    </div>

    <div class="timeline" id="project-timeline">
      <div class="timeline__wrap">
        <div class="timeline__items" id="timeline-items">
          <!-- èŠ‚ç‚¹å†…å®¹å°†ç”± JS åŠ¨æ€ç”Ÿæˆ -->
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/gh/squarechip/timeline@master/dist/js/timeline.min.js"></script>
  <script src="https://www.liyansheng.top/cdn/timedown.min.js"></script>
  <script>
    // è·å–è·¯å¾„å‚æ•°
    const urlParams = new URLSearchParams(window.location.search);
    const number = urlParams.get('number');
    fetch(`https://mini.liyansheng.top/v1/api/targeted-services/service-info/${number}`)
      .then(response => response.json())
      .then(data => {
        const pageData = data.data;
        // æœåŠ¡ä¿¡æ¯æ•°æ®
        const serviceInfo = {
          content: pageData.content,
          number: pageData.number,
          customer: pageData.customerName,
          startTime: pageData.startTime,
          endTime: pageData.endTime
        };
        // æ¸²æŸ“æœåŠ¡ä¿¡æ¯
        const serviceInfoEl = document.getElementById("service-info");
        serviceInfoEl.innerHTML = `
            <div style='text-align:center;'>
            <h3><span>æœ¨å­ç©ºé—´<img src="https://cdn.qiniu.liyansheng.top/img/graphic-4005286_640.png" style="max-width:15%;height:auto;" alt="">é¡¹ç›®è¿›åº¦</span></h3>
            
            </div>
          <p class='lead'>ç¼–å·ï¼š${serviceInfo.number}</p>
          <p class='lead'>å®¢æˆ·ï¼š${serviceInfo.customer}</p>
            <p class='lead'>å‘¨æœŸï¼š${new Date(serviceInfo.startTime).toLocaleDateString()} - ${new Date(serviceInfo.endTime).toLocaleDateString()}</p>
          <p class='lead'>é¡¹ç›®ï¼š${serviceInfo.content}</p>
          <p class='lead' id='countdown'>â³ï¼š<span id='countdown-timer'></span></p>
        `;
        // èŠ‚ç‚¹æ•°æ® JSONï¼Œæ–°å¢ cover å­—æ®µï¼ˆå¯ç”¨å›¾ç‰‡é“¾æ¥æˆ– base64 å ä½å›¾ï¼‰
        const timelineData = pageData.timeNodeList || [];
        // æ¸²æŸ“èŠ‚ç‚¹ï¼Œå¢åŠ  cover ç¤ºæ„å›¾
        const itemsContainer = document.getElementById("timeline-items");
        timelineData.forEach((node, index) => {
          const isFirst = index === 0;// åˆ¤æ–­æ˜¯å¦ç¬¬ä¸€ä¸ª
          const item = document.createElement("div");
          item.className = "timeline__item";
          item.innerHTML = `
            <div class="timeline__content ${isFirst ? 'is-current' : ''}" ${isFirst ? 'style="position: relative;"' : ''}>
              ${isFirst ? '<span class="latest-badge">New</span>' : ''}
              <div class="meta"><span>â°${new Date(node.createdAt).toLocaleString()}</span></div>
              <h3>âœ…${node.title}</h3>
              <p>${node.description}</p>
              ${node.coverUrl ? `<div style='margin:8px 0'><img src='${node.coverUrl}' alt='ç¤ºæ„å›¾' style='max-width:80%;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.08);'></div>` : ''}
            </div>
          `;
          itemsContainer.appendChild(item);
        });
        // åˆå§‹åŒ–æ—¶é—´è½´
        timeline(document.querySelectorAll('.timeline'), {
          verticalStartPosition: 'right',
          verticalTrigger: '150px'
        });
        // ä¸»é¢˜åˆ‡æ¢é€»è¾‘
        const btn = document.getElementById('theme-toggle');
        btn.addEventListener('click', () => {
          document.body.classList.toggle('dark-theme');
          document.body.classList.toggle('light-theme');
          btn.textContent = document.body.classList.contains('dark-theme') ? 'åˆ‡æ¢ä¸ºæµ…è‰²' : 'åˆ‡æ¢ä¸ºæš—è‰²';
        });
        btn.textContent = 'åˆ‡æ¢ä¸ºæµ…è‰²';
        // åˆå§‹åŒ–å€’è®¡æ—¶ï¼Œç¡®ä¿èŠ‚ç‚¹å·²æ¸²æŸ“
        new Timedown({
          id: 1,
          endTime: new Date(serviceInfo.endTime).getTime(),
          endText: 'å·²ç»“æŸ',
          selector: '#countdown-timer',
          format: '{d}å¤© {hh}å°æ—¶ {mm}åˆ†é’Ÿ {ss}ç§’',
          endCallback: () => alert('å€’è®¡æ—¶ç»“æŸï¼')
        });
      })
      .catch(error => {
        console.error('Error fetching service info:', error);
      });


  </script>
</body>

</html>